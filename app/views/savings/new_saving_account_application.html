<div class="col-md-12" ng-controller="CreateSavingAccountController">
    <ul class="breadcrumb">
        <li ng-show="centerEntity"><a href="#/viewcenter/{{groupId}}">{{groupName}}</a></li>
        <li ng-show="groupName && !centerEntity"><a href="#/viewgroup/{{groupId}}">{{groupName}}</a></li>
        <li ng-show="clientName"><a href="#/viewclient/{{clientId}}">{{clientName}}</a></li>
        <li class="active">{{'label.anchor.savingapplication' | translate}}</li>
    </ul>

    <api-validate></api-validate>
    <form name="newsavingccountform" class="form-horizontal well" novalidate="" rc-submit="submit()">
        <legend>{{'label.heading.savingapplication' | translate}}</legend>

        <div class="form-group">
            <label class="control-label col-sm-2">{{'label.input.product' | translate}}<span class="required">*</span></label>
            <div class="col-sm-3">
                <select id="productId" class="form-control" required ng-model="formData.productId" ng-options="product.id as product.name for product in products" ng-change="changeProduct()">
                    <option class="displaynone" value="">{{'label.selectsavingproduct' | translate}}</option>
                </select>
            </div>

            <div ng-show="formData.productId">
                <label class="control-label col-sm-2">{{'label.input.submittedon' | translate}}<span class="required">*</span></label>
                <div class="col-sm-2">
                    <input id="submittedOnDate" type="text" class="form-control" ng-model="date.submittedOnDate" datepicker-pop="dd MMMM yyyy" is-open="opened" min="minDate" max="restrictDate" sort>
                </div>
            </div>
        </div>

        <div ng-show="formData.productId">
            <div class="form-group">
                <label class="control-label col-sm-2">{{'label.input.fieldofficer' | translate}}</label>
                <div class="col-sm-2">
                    <select id="fieldOfficerId" class="form-control" ng-model="formData.fieldOfficerId" ng-options="fieldOfficer.id as fieldOfficer.displayName for fieldOfficer in fieldOfficers">
                        <option value="">{{'label.selectfieldofficer' | translate}}</option>
                    </select>
                </div>

                <label class="control-label col-sm-3">{{'label.input.externalid' | translate}}</label>
                <div class="col-sm-2">
                    <input id="externalId" class="form-control" ng-model="formData.externalId">
                </div>
            </div>

            <hr>
            <h3>{{'label.heading.terms' | translate}}</h3>

            <div class="form-group">
                <label class="control-label col-sm-2">{{'label.heading.currency' | translate}}</label>
                <span class="col-sm-2">{{data.currency.name}} ({{data.currency.displaySymbol}})</span>

                <label class="control-label col-sm-3">{{'label.heading.decimalplaces' | translate}}</label>
                <span class="col-sm-2">{{data.currency.decimalPlaces}}</span>
            </div>

            <div class="form-group">
                <label class="control-label col-sm-2">{{'label.input.nominalannualinterestrate' | translate}}<span class="required">*</span></label>
                <div class="col-sm-2">
                    <input id="nominalAnnualInterestRate" name="nominalannualinterestrate" type="text" class="form-control" required ng-model="formData.nominalAnnualInterestRate" number-format>
                </div>

                <label class="control-label col-sm-3">{{'label.input.interestcompoundingperiod' | translate}}<span class="required">*</span></label>
                <div class="col-sm-2">
                    <select id="interestCompoundingPeriodType" class="form-control" ng-model="formData.interestCompoundingPeriodType" ng-options="type.id as type.value for type in data.interestCompoundingPeriodTypeOptions"></select>
                </div>
            </div>

            <div class="form-group">
                <label class="control-label col-sm-2">{{'label.input.currencyinmultiplesof' | translate}}</label>
                <span class="col-sm-2">{{data.currency.inMultiplesOf}}</span>

                <label class="control-label col-sm-3">{{'label.input.interestpostingperiod' | translate}}<span class="required">*</span></label>
                <div class="col-sm-2">
                    <select id="interestPostingPeriodType" class="form-control" ng-model="formData.interestPostingPeriodType" ng-options="type.id as type.value for type in data.interestPostingPeriodTypeOptions"></select>
                </div>
            </div>

            <div class="form-group">
                <label class="control-label col-sm-2">{{'label.input.interestcalculatedusing' | translate}}<span class="required">*</span></label>
                <div class="col-sm-2">
                    <select id="interestCalculationType" class="form-control" ng-model="formData.interestCalculationType" ng-options="type.id as type.value for type in data.interestCalculationTypeOptions"></select>
                </div>

                <label class="control-label col-sm-3">{{'label.input.daysinyears' | translate}}<span class="required">*</span></label>
                <div class="col-sm-2">
                    <select id="interestCalculationDaysInYearType" class="form-control" ng-model="formData.interestCalculationDaysInYearType" ng-options="type.id as type.value for type in data.interestCalculationDaysInYearTypeOptions"></select>
                </div>
            </div>

            <div class="form-group">
                <label class="control-label col-sm-2">{{'label.input.minimumopeningbalance' | translate}}</label>
                <div class="col-sm-2">
                    <input id="minRequiredOpeningBalance" type="text" class="form-control" ng-model="formData.minRequiredOpeningBalance" number-format>
                </div>

                <label class="control-label col-sm-3">{{'label.input.lockinPeriodFrequency' | translate}}</label>
                <div class="col-sm-4 form-inline">
                    <input id="lockinPeriodFrequency" type="text" class="form-control" ng-model="formData.lockinPeriodFrequency">
                    <select id="lockinPeriodFrequencyType" class="form-control" ng-model="formData.lockinPeriodFrequencyType" ng-options="type.id as type.value for type in data.lockinPeriodFrequencyTypeOptions">
                        <option value="">{{'label.selectone' | translate}}</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label class="control-label col-sm-2">{{'label.input.applywithdrawalfeefortransfers' | translate}}</label>
                <input type="checkbox" class="col-sm-1" ng-model="formData.withdrawalFeeForTransfers">
            </div>

            <div class="form-group">
                <label class="control-label col-sm-2">{{'label.input.allowoverdraft' | translate}}</label>
                <input type="checkbox" class="col-sm-1" ng-model="formData.allowOverdraft">

                <div ng-show="formData.allowOverdraft">
                    <label class="control-label col-sm-4">{{'label.input.overdraftlimit' | translate}}</label>
                    <div class="col-sm-2">
                        <input id="overdraftLimit" type="text" class="form-control" ng-model="formData.overdraftLimit">
                    </div>
                </div>
            </div>

            <div class="form-group" ng-hide="formData.allowOverdraft">
                <label class="control-label col-sm-2">{{'label.input.enforceMinRequiredBalance' | translate}}</label>
                <input type="checkbox" class="col-sm-1" ng-model="formData.enforceMinRequiredBalance">

                <label class="control-label col-sm-4">{{'label.input.minRequiredBalance' | translate}}</label>
                <div class="col-sm-2">
                    <input id="minRequiredBalance" type="text" class="form-control" ng-model="formData.minRequiredBalance" number-format>
                </div>
            </div>

            <hr>
            <h3>{{'label.heading.charges' | translate}}</h3>

            <div class="form-group">
                <div class="col-sm-3">
                    <select class="form-control" ng-model="chargeId" ng-options="charge.id as charge.name for charge in chargeOptions|filter:data.currency.code:strict">
                        <option value="">{{'label.selectcharge' | translate}}</option>
                    </select>
                </div>
                <a class="btn btn-primary" ng-click="addCharge(chargeId)"><i class="icon-plus icon-white"></i> {{'label.button.add' | translate}}</a>
                <span class="error" ng-show="errorchargeevent">{{'label.' + labelchargeerror | translate}}</span>
            </div>

            <table class="table" ng-show="charges.length > 0">
                <tr class="graybg">
                    <th>{{'label.heading.name' | translate}}</th>
                    <th>{{'label.heading.type' | translate}}</th>
                    <th>{{'label.heading.amount' | translate}}</th>
                    <th>{{'label.heading.collectedon' | translate}}</th>
                    <th>{{'label.heading.date' | translate}}</th>
                    <th>{{'label.heading.repaymentsevery' | translate}}</th>
                    <th>{{'label.heading.actions' | translate}}</th>
                </tr>
                <tr ng-repeat="charge in charges">
                    <td>{{charge.name}} ({{charge.currency.displaySymbol}})</td>
                    <td>{{charge.chargeCalculationType.value}}</td>
                    <td><input id="charges[{{$index}}].amount" type="text" class="form-control" placeholder="{{'label.input.amount' | translate}}" ng-model="charge.amount" number-format></td>
                    <td>{{charge.chargeTimeType.value}}</td>
                    <td ng-switch on="charge.chargeTimeType.value">
                        <input id="charges[{{$index}}].feeOnMonthDay" type="text" class="form-control date-disable" readonly ng-model="charge.feeOnMonthDay" datepicker-pop="dd MMMM" is-open="opened" ng-switch-when='Annual Fee'>
                        <input id="charges[{{$index}}].dueDate" type="text" class="form-control date-disable" readonly ng-model="charge.dueDate" datepicker-pop="dd MMMM yyyy" is-open="opened" ng-switch-when='Specified due date'>
                        <input type="text" class="form-control date-disable" readonly ng-model="charge.feeOnMonthDay" datepicker-pop="dd MMMM" is-open="opened" ng-switch-when='Monthly Fee'>
                        <input id="charges[{{$index}}].dueDate" class="form-control" ng-model="charge.dueDate" datepicker-pop="dd MMMM yyyy" is-open="opened" ng-switch-when='Weekly Fee'>
                    </td>
                    <td ng-switch on="charge.chargeTimeType.value">
                        <input id="charges[{{$index}}].feeInterval" class="form-control" type="text" ng-model="charge.feeInterval" ng-switch-when='Monthly Fee'>
                        <input id="charges[{{$index}}].feeInterval" class="form-control" type="text" ng-model="charge.feeInterval" ng-switch-when='Weekly Fee'>
                    </td>
                    <td><a ng-click="deleteCharge($index)"><i class="icon-remove icon-white"></i></a></td>
                </tr>
            </table>
        </div>

        <div class="center">
            <a id="cancel" class="btn btn-default" ng-click="cancel()">{{'label.button.cancel' | translate}}</a>
            <button id="save" type="submit" class="btn btn-primary" ng-show="formData.productId" has-permission='CREATE_SAVINGSACCOUNT'>{{'label.button.save' | translate}}</button>
        </div>
    </form>
</div>